/*!
 * vdom-engine.js v0.1.2
 * (c) 2016 Jade Gu
 * Released under the MIT License.
 */
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.Vengine=n()}(this,function(){"use strict";function e(e){ne.push(e)}function n(e){ne=ne.filter(function(n){return n!==e})}function t(e){for(var n=0,t=ne.length;t>n;n++){var r=ne[n],o=r.test,a=typeof o,i=!1;if("string"===a?e===o&&(i=!0):"function"===a?o(e)&&(i=!0):i=o.test(e),i)return r}}function r(e,n,t){var r=d(n);e[r]=t}function o(e,n){var t=d(n);e[t]=""}function a(e,n,t,r){if(t!==r){var o=d(n);null==t?e[o]="":e[o]=t}}function i(e,n,t){var r=p(n);e.setAttribute(r,t)}function c(e,n){var t=p(n);e.removeAttribute(t)}function l(e,n,t,r){if(t!==r){var o=p(n);null==t?e.removeAttribute(o):e.setAttribute(o,t)}}function u(e,n,t,r){var o=h(n);e.setAttributeNS(r.namespace,o,t)}function f(e,n){var t=h(n);e.removeAttribute(t)}function v(e,n,t,r,o){if(t!==r){var a=h(n);null==t?e.removeAttribute(a):e.setAttributeNS(o.namespace,a,t)}}function d(e){return e.match(te)[1]}function p(e){var n=e.match(re);return"attr"===n[1]?n[2]:n[0]}function h(e){return e.match(oe)[1]}function s(e,n){for(var t in n)b(e,t,n[t])}function m(e,n){for(var t in n)e[t]=""}function y(e,n,t){if(n!==t){if(!t&&n)return void m(e,n);if(t&&!n)return void s(e,t);var r={};for(var o in n)r[o]=!0,n[o]!==t[o]&&b(e,o,t[o]);for(var o in t)r[o]!==!0&&n[o]!==t[o]&&b(e,o,t[o])}}function g(e,n){return e+n.charAt(0).toUpperCase()+n.substring(1)}function b(e,n,t){return!ue[n]&&ve.test(t)?void(e[n]=t+"px"):("float"===n&&(n="cssFloat"),null!=t&&"boolean"!=typeof t||(t=""),void(e[n]=t))}function k(e){return e.replace("on-","on").toLowerCase()}function w(e,n,t){if(n=k(n),1===de[n])return void(e[n]=t);var r=e.eventStore||(e.eventStore={});r[n]=t,ge[n]||(document.addEventListener(n.substr(2),A,!1),ge[n]=!0),se&&n===ye&&e.addEventListener("click",me,!1);var o=e.nodeName;"onchange"!==n||"INPUT"!==o&&"TEXTAREA"!==o||w(e,"oninput",t)}function x(e,n){if(n=k(n),1===de[n])return void(e[n]=null);var t=e.eventStore||(e.eventStore={});delete t[n],se&&n===ye&&e.removeEventListener("click",me,!1);var r=e.nodeName;"onchange"!==n||"INPUT"!==r&&"TEXTAREA"!==r||delete t.oninput}function C(e,n,t,r){t!==r&&(null==r?x(e,n):w(e,n,t))}function A(e){for(var n=e.target,t=e.type,r="on"+t,o=null;n;){var a=n,i=a.eventStore,c=i&&i[r];if(c){if(o||(o=E(e)),o.currentTarget=n,c.call(n,o),o.$cancalBubble)break;n=n.parentNode}else n=n.parentNode}}function E(e){var n={},t=function(){return n.$cancalBubble=!0};n.nativeEvent=e;for(var r in e)"function"!=typeof e[r]?n[r]=e[r]:"stopPropagation"===r||"stopImmediatePropagation"===r?n[r]=t:n[r]=e[r].bind(e);return n}function N(e){return e}function I(e,n){return function(){return e.apply(this,arguments),n.apply(this,arguments)}}function O(e,n){for(var t=e.length,r=-1;t--;){var o=e[++r];be(o)?flattenChildren(o,n):null!=o&&"boolean"!=typeof o&&(n[n.length]=o)}}function S(e,n){if(!n)return e;for(var t=Object.keys(n),r=t.length;r--;)e[t[r]]=n[t[r]];return e}function T(){return++ke}function P(e,n){for(var r in n){var o=t(r);if(o){var a=n[r];null!=a&&o.attach(e,r,a,n)}}}function R(e,n,r){var o={},a=null;for(var i in n)o[i]=!0,a=t(i),a&&a.patch(e,i,r[i],n[i],r,n);for(var i in r)o[i]!==!0&&(a=t(i),a&&a.patch(e,i,r[i],n[i],r,n))}function U(e){return{vtype:Ee,comment:e}}function j(e,n){var t=e.vtype,r=null;return t?t===Ce?r=B(e,n):t===Ae?r=H(e,n):t===Ee&&(r=document.createComment(e.comment)):r=document.createTextNode(""+e),r}function z(e,n){var t=e.vtype;t===Ce?$(e,n):t===Ae&&Y(e,n)}function L(e,n,t){var r=t,o=n.vtype;return o?o===Ce?r=F(e,n,r):o===Ae&&(r=X(e,n,r)):(r.newText=n+"",Ne[Ne.length]=r),r}function B(e,n){var t=e.type,r=e.props,o=null;return"svg"===t||n===we?(n=we,o=document.createElementNS(we,t)):o=document.createElement(t),D(o,r.children),P(o,r),o}function D(e,n){for(var t=e.namespaceURI,r=0,o=n.length;o>r;r++){var a=n[r],i=j(n[r],t);i.vnode=a,e.appendChild(i)}}function F(e,n,t){var r=e.props,o=(e.type,n.props),a=r["prop-innerHTML"],i=r.children,c=o.children;if(null==a&&i.length){var l=G(t,i,c);W(t,c,l),t.props=r,t.newProps=o,Oe[Oe.length]=t}else R(t,r,o),D(t,c);return t}function W(e,n,t){for(var r=n.length,o=e.childNodes,a=e.namespaceURI,i=0;r>i;i++){var c=n[i],l=t[i],u=null;if(l){var f=l.vnode;u=l,l.vnode=null,c!==f&&(u=L(f,c,l));var v=o[i];v!==u&&e.insertBefore(u,v||null)}else u=j(c,a),e.insertBefore(u,o[i]||null);u.vnode=c}}function G(e,n,t){var r=e.childNodes,o=n.length,a=t.length,i=Array(o),c=Array(a);return M(n,t,r,c,i),V(n,t,r,c,i),c}function M(e,n,t,r,o){for(var a=e.length,i=n.length,c=0;a>c;c++)for(var l=e[c],u=0;i>u;u++)if(!r[u]){var f=n[u];if(l===f){r[u]=t[c],o[c]=!0;break}}}function V(e,n,t,r,o){for(var a=e.length,i=n.length,c=null,l=0;a>l;l++)if(!o[l]){for(var u=t[l],f=e[l],v=f.type,d=f.key,p=!1,h=0;i>h;h++)if(!r[h]){var s=n[h];if(s.type===v&&s.key===d){r[h]=u,p=!0;break}}p||(c||(c=[]),c[c.length]=u,z(f,u))}if(c)for(var l=0,m=c.length;m>l;l++){var u=c[l];u.parentNode.removeChild(u)}}function $(e,n){for(var t=e.props,r=t.children,o=n.childNodes,a=0,i=r.length;i>a;a++)z(r[a],o[a]);n.eventStore=null;for(var c in t)pe.test(c)&&(c=k(c),de[c]===!0&&(n[c]=null))}function H(e,n){var t=q(e),r=j(t,n);return r.cache=r.cache||{},r.cache[e.id]=t,r}function X(e,n,t){var r=e.id,o=t.cache[r];delete t.cache[r];var a=q(n),i=J(o,a,t);return i.cache=i.cache||{},i.cache[n.id]=a,i!==t&&S(i.cache,t.cache),i}function Y(e,n){var t=e.id,r=n.cache[t];delete n.cache[t],z(r,n)}function q(e){var n=e.type,t=e.props,r=n(t);if(r&&r.render&&(r=r.render()),null===r||r===!1)r=U("component placeholder: "+T());else if(!r||!r.vtype)throw new Error("@"+n.name+"#render:You may have returned undefined, an array or some other invalid object");return r}function J(e,n,t){var r=t;if(null==n)z(e,t),t.parentNode.removeChild(t);else if(e.type!==n.type||n.key!==e.key)z(e,t),r=j(n,t.namespaceURI),t.parentNode.replaceChild(r,t);else if(e!==n){var o=e.vtype;o===Ce?r=F(e,n,t):o===Ae&&(r=X(e,n,t))}return r}function K(e,n,t){if(!e.vtype)throw new Error("cannot render "+e+" to container");var r=n[xe]||(n[xe]=T()),o=Te[r];if(o)return void(o===!0?Te[r]={vnode:e,callback:t}:(o.vnode=e,t&&(o.callback=o.callback?I(o.callback,t):t)));Te[r]=!0;var a=null,i=null;if(a=Pe[r])i=J(a,e,n.firstChild);else{i=j(e,n.namespaceURI);for(var c=null;c=n.lastChild;)n.removeChild(c);n.appendChild(i)}Pe[r]=e,Ie(),Se(),o=Te[r],delete Te[r],be(o)&&renderTreeIntoContainer(o[0],n,o[1]),t&&t()}function Q(e){if(!e.nodeName)throw new Error("expect node");var n=e[xe],t=null;return(t=Pe[n])?(z(t,e.firstChild),e.removeChild(e.firstChild),delete Pe[n],!0):!1}function Z(e,n){var t={};if(null!=n)for(var r in n)t[r]=n[r];var o=e.defaultProps;if(o)for(var r in o)void 0===t[r]&&(t[r]=o[r]);for(var a=arguments.length,i=[],c=2;a>c;c++){var l=arguments[c];be(l)?O(l,i):null!=l&&"boolean"!=typeof l&&(i[i.length]=l)}t.children=i;var u=null,f=typeof e;if("string"===f)u={vtype:Ce,type:e,props:t};else{if("function"!==f)throw new Error("unexpect type [ "+e+" ]");u={id:T(),vtype:Ae,type:e,props:t}}return u}function _(e){return null!=e&&!!e.vtype}function ee(e){var n=function(){for(var n=arguments.length,t=Array(n),r=0;n>r;r++)t[r]=arguments[r];return Z.apply(void 0,[e].concat(t))};return n.type=e,n}var ne=[],te=/^prop-(.+)/,re=/^(attr|data|aria)-(.+)/,oe=/^attrns-(.+)/,ae={test:te,attach:r,detach:o,patch:a},ie={test:re,attach:i,detach:c,patch:l},ce={test:oe,attach:u,detach:f,patch:v},le={test:"style",attach:s,detach:m,patch:y},ue={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridColumn:1,fontWeight:1,lineClamp:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},fe=["Webkit","ms","Moz","O"];Object.keys(ue).forEach(function(e){fe.forEach(function(n){ue[g(n,e)]=1})});var ve=/^-?\d+(\.\d+)?$/,de={onmouseleave:1,onmouseenter:1,onload:1,onunload:1,onscroll:1,onfocus:1,onblur:1,onrowexit:1,onbeforeunload:1,onstop:1,ondragdrop:1,ondragenter:1,ondragexit:1,ondraggesture:1,ondragover:1,oncontextmenu:1},pe=/^on-.+/i,he={test:pe,attach:w,detach:x,patch:C},se="ontouchstart"in document,me=function(){},ye="onclick",ge={},be=Array.isArray,ke=0;Object.freeze||(Object.freeze=N);var we="http://www.w3.org/2000/svg",xe="liteid",Ce=1,Ae=2,Ee=3,Ne=[],Ie=function(){var e=Ne.length;if(e){for(var n=Ne,t=-1;e--;){var r=n[++t];r.nodeValue=r.newText}Ne.length=0}},Oe=[],Se=function(){var e=Oe.length;if(e){for(var n=Oe,t=-1;e--;){var r=n[++t];R(r,r.props,r.newProps),r.props=r.newProps=null}Oe.length=0}},Te={},Pe={};e(ie),e(ae),e(le),e(he),e(ce);var Re={createElement:Z,createFactory:ee,isValidElement:_,addDirective:e,removeDirective:n,render:K,destroy:Q};return Re});