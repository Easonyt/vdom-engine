/*!
 * vdom-engine.js v0.1.6
 * (c) 2016 Jade Gu
 * Released under the MIT License.
 */
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.Vengine=n()}(this,function(){"use strict";function e(e,n){Q[e]=n}function n(e){delete Q[e]}function t(e){var n=e.match(Z);return n?(_=n[2],Q[n[1]]):void 0}function r(e,n,r){var o=t(n);o&&o.attach(e,_,r)}function o(e,n){var r=t(n);r&&r.detach(e,_)}function a(e,n){for(var t in n)"children"!==t&&null!=n[t]&&r(e,t,n[t])}function i(e,n,t){for(var a in n)"children"!==a&&(t.hasOwnProperty(a)?t[a]!==n[a]&&(null==t[a]?o(e,a):r(e,a,t[a])):o(e,a));for(var a in t)"children"!==a&&(n.hasOwnProperty(a)||r(e,a,t[a]))}function c(e,n,t){e[n]=t}function l(e,n){e[n]=""}function u(e,n,t){e.setAttribute(n,t+"")}function d(e,n){e.removeAttribute(n)}function f(e){return"function"==typeof e}function p(){}function v(e){return e}function s(e,n){return function(){return e.apply(this,arguments),n.apply(this,arguments)}}function h(e,n,t){for(var r=e.length,o=-1;r--;){var a=e[++o];te(a)?h(a,n,t):n(a,t)}}function y(e,n){if(!n)return e;for(var t=Object.keys(n),r=t.length;r--;)e[t[r]]=n[t[r]];return e}function m(){return++re}function x(e,n){e.eventStore=null;for(var t in n)0===t.indexOf("on-")&&(t=g(t),oe[t]&&(e[t]=null))}function g(e){return e.replace(/^on-/,"on").toLowerCase()}function b(e,n,t){if(n="on"+n,1===oe[n])return void(e[n]=t);var r=e.eventStore||(e.eventStore={});r[n]=t,ue[n]||(document.addEventListener(n.substr(2),w,!1),ue[n]=!0),ie&&n===le&&e.addEventListener("click",ce,!1);var o=e.nodeName;"onchange"!==n||"INPUT"!==o&&"TEXTAREA"!==o||b(e,"oninput",t)}function k(e,n){if(n="on"+n,1===oe[n])return void(e[n]=null);var t=e.eventStore||(e.eventStore={});delete t[n],ie&&n===le&&e.removeEventListener("click",ce,!1);var r=e.nodeName;"onchange"!==n||"INPUT"!==r&&"TEXTAREA"!==r||delete t.oninput}function w(e){for(var n=e.target,t=e.type,r="on"+t,o=null;n;){var a=n,i=a.eventStore,c=i&&i[r];if(c){if(o||(o=N(e)),o.currentTarget=n,c.call(n,o),o.$cancalBubble)break;n=n.parentNode}else n=n.parentNode}}function N(e){var n={},t=function(){return n.$cancalBubble=!0};n.nativeEvent=e,n.persist=p;for(var r in e)"function"!=typeof e[r]?n[r]=e[r]:"stopPropagation"===r||"stopImmediatePropagation"===r?n[r]=t:n[r]=e[r].bind(e);return n}function C(e,n,t){O(e.style,n,t)}function E(e,n){e.style[n]=""}function I(e,n){return e+n.charAt(0).toUpperCase()+n.substring(1)}function O(e,n,t){return!fe[n]&&ve.test(t)?void(e[n]=t+"px"):("float"===n&&(n="cssFloat"),null!=t&&"boolean"!=typeof t||(t=""),void(e[n]=t))}function U(e,n,t){var r=e.vtype,o=null;return r?r===ye?o=V(e,n,t):r===me?o=D(e,n,t):r===xe&&(o=document.createComment("react-empty: "+e.uid)):o=document.createTextNode(e),o}function A(e,n,t,r){var o=e.vtype;return o===me?F(e,n,t,r):o!==ye?t:(null!=e.props[ge]?(M(e,n,t,r),z(n,t,r)):(S(e,n,t,r),M(e,n,t,r)),t)}function S(e,n,t,r){var o={removes:[],updates:[],creates:[]};L(o,e,n,t,r),h(o.removes,T),h(o.updates,P),h(o.creates,j)}function P(e){if(e){var n=e.node;if(!e.shouldIgnoreUpdate){var t=e.vnode,r=e.newVnode,o=e.context;t.vtype===ye?M(t,r,n,o):t.vtype===me?n=F(t,r,n,o):t.vtype||(n.nodeValue=r)}if(e.index!==e.fromIndex){var a=n.parentNode.childNodes[index];a!==n&&n.parentNode.insertBefore(n,a)}return n}}function T(e){R(e.vnode,e.node),e.node.parentNode.removeChild(e.node)}function j(e){var n=e.parentNode,t=n.childNodes[e.index],r=U(e.vnode,e.context,n.namespaceURI);n.insertBefore(r,t)}function R(e,n){var t=e.vtype;t===ye?B(e,n):t===me&&W(e,n)}function V(e,n,t){var r=e.type,o=e.props,i=null;return"svg"===r||t===se?(i=document.createElementNS(se,r),t=se):i=document.createElement(r),z(i,o.children,n),a(i,o),o[be]&&o[be].call(null,i,o),o[ke]&&Ee.push({type:ke,node:i,props:o}),i}function z(e,n,t){for(var r=e.namespaceURI,o=0,a=n.length;a>o;o++)e.appendChild(U(n[o],t,r))}function L(e,n,t,r,o){var a=r.childNodes,i=n.props.children,c=t.props.children,l=i.length,u=c.length;if(0!==l)if(0!==u){for(var d={},f=Array(u),p=null,v=null,s=0;l>s;s++)for(var h=i[s],y=0;u>y;y++)if(!f[y]){var m=c[y];if(h===m){var x=!0;o&&h.vtype===me&&h.type.length>1&&(x=!1),f[y]={shouldIgnoreUpdate:x,vnode:h,newVnode:m,node:a[s],context:o,index:y,fromIndex:s},d[s]=!0;break}}for(var s=0;l>s;s++)if(!d[s]){for(var g=i[s],b=!0,y=0;u>y;y++)if(!f[y]){var k=c[y];if(k.type===g.type&&k.key===g.key){f[y]={vnode:g,newVnode:k,node:a[s],context:o,index:y,fromIndex:s},b=!1;break}}b&&(p||(p=[]),p.push({vnode:g,node:a[s]}))}for(var s=0;u>s;s++){var w=f[s];w?w.vnode.vtype===ye&&L(e,w.vnode,w.newVnode,w.node,w.context):(v||(v=[]),v.push({vnode:c[s],parentNode:r,context:o,index:s}))}p&&e.removes.push(p),v&&e.creates.push(v),e.updates.push(f)}else for(var s=0;l>s;s++)e.removes.push({vnode:i[s],node:a[s]});else for(var s=0;u>s;s++)e.creates.push({vnode:c[s],parentNode:r,context:o,index:s})}function M(e,n,t){var r=n.props;return r[we]&&r[we].call(null,t,r),i(t,e.props,r),r[Ne]&&r[Ne].call(null,t,r),t}function B(e,n){for(var t=e.props,r=t.children,o=n.childNodes,a=0,i=r.length;i>a;a++)R(r[a],o[a]);f(t[Ce])&&t[Ce].call(null,n,t),x(n,t)}function D(e,n,t){var r=$(e,n),o=U(r,n,t);return o.cache=o.cache||{},o.cache[e.uid]=r,o}function F(e,n,t,r){var o=e.uid,a=t.cache[o];delete t.cache[o];var i=$(n,r),c=G(a,i,t,r);return c.cache=c.cache||{},c.cache[n.uid]=i,c!==t&&y(c.cache,t.cache),c}function W(e,n){var t=e.uid,r=n.cache[t];delete n.cache[t],R(r,n)}function $(e,n){var t=e.type,r=e.props,o=t(r,n);if(o&&o.render&&(o=o.render()),null===o||o===!1)o={vtype:xe,uid:m()};else if(!o||!o.vtype)throw new Error("@"+t.name+"#render:You may have returned undefined, an array or some other invalid object");return o}function G(e,n,t,r){var o=t;return null==n?(R(e,t),t.parentNode.removeChild(t)):e.type!==n.type||e.key!==n.key?(R(e,t),o=U(n,r,t.namespaceURI),t.parentNode.replaceChild(o,t)):(e!==n||r)&&(o=A(e,n,t,r)),o}function H(e,n,t,r){if(!e.vtype)throw new Error("cannot render "+e+" to container");var o=n[he]||(n[he]=m()),a=Oe[o];if(f(t)&&(r=t,t=void 0),a)return void(a===!0?Oe[o]={vnode:e,context:t,callback:r}:(a.vnode=e,a.context=t,r&&(a.callback=a.callback?s(a.callback,r):r)));if(Oe[o]=!0,Ue.hasOwnProperty(o))G(Ue[o],e,n.firstChild,t);else{for(var i=U(e,t,n.namespaceURI),c=null;c=n.lastChild;)n.removeChild(c);n.appendChild(i)}Ue[o]=e,Ie(),a=Oe[o],Oe[o]=null,"object"==typeof a&&H(a.vnode,n,a.context,a.callback),r&&r()}function X(e){if(!e.nodeName)throw new Error("expect node");var n=e[he],t=null;return(t=Ue[n])?(R(t,e.firstChild),e.removeChild(e.firstChild),delete Ue[n],delete Oe[n],!0):!1}function Y(e,n){var t={},r=null;if(null!=n)for(var o in n)"key"===o?void 0!==n.key&&(r=""+n.key):t[o]=n[o];var a=e.defaultProps;if(a)for(var o in a)void 0===t[o]&&(t[o]=a[o]);for(var i=arguments.length,c=[],l=2;i>l;l++){var u=arguments[l];te(u)?h(u,K,c):K(u,c)}t.children=c;var d=null;if("string"==typeof e)d=ye;else{if("function"!=typeof e)throw new Error("unexpect type [ "+e+" ]");d=me}var f={vtype:d,type:e,props:t,key:r};return d===me&&(f.uid=m()),f}function q(e){return null!=e&&!!e.vtype}function J(e){var n=function(){for(var n=arguments.length,t=Array(n),r=0;n>r;r++)t[r]=arguments[r];return Y.apply(void 0,[e].concat(t))};return n.type=e,n}function K(e,n){null!=e&&"boolean"!=typeof e&&(n[n.length]=e.vtype?e:""+e)}var Q={},Z=/^([^-]+)-(.+)$/,_=null,ee={attach:c,detach:l},ne={attach:u,detach:d},te=Array.isArray,re=0;Object.freeze||(Object.freeze=v);var oe={onmouseleave:1,onmouseenter:1,onload:1,onunload:1,onscroll:1,onfocus:1,onblur:1,onrowexit:1,onbeforeunload:1,onstop:1,ondragdrop:1,ondragenter:1,ondragexit:1,ondraggesture:1,ondragover:1,oncontextmenu:1},ae={attach:b,detach:k},ie="ontouchstart"in document,ce=function(){},le="onclick",ue={},de={attach:C,detach:E},fe={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridColumn:1,fontWeight:1,lineClamp:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},pe=["Webkit","ms","Moz","O"];Object.keys(fe).forEach(function(e){pe.forEach(function(n){fe[I(n,e)]=1})});var ve=/^-?\d+(\.\d+)?$/,se="http://www.w3.org/2000/svg",he="liteid",ye=1,me=2,xe=3,ge="prop-innerHTML",be="hook-willMount",ke="hook-didMount",we="hook-willUpdate",Ne="hook-didUpdate",Ce="hook-willUnmount",Ee=[],Ie=function(){var e=Ee.length;if(e){for(var n=Ee,t=-1;e--;){var r=n[++t];r.props[r.type].call(null,r.node,r.props)}Ee.length=0}},Oe={},Ue={};e("attr",ne),e("prop",ee),e("on",ae),e("css",de);var Ae={createElement:Y,createFactory:J,isValidElement:q,addDirective:e,removeDirective:n,render:H,destroy:X};return Ae});