/*!
 * vdom-engine.js v0.1.6
 * (c) 2016 Jade Gu
 * Released under the MIT License.
 */
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.Vengine=n()}(this,function(){"use strict";function e(e,n){Z[e]=n}function n(e){delete Z[e]}function t(e){var n=e.match(_);return n?(ee=n[2],Z[n[1]]):void 0}function o(e,n,o){var r=t(n);r&&r.attach(e,ee,o)}function r(e,n){var o=t(n);o&&o.detach(e,ee)}function a(e,n){for(var t in n)"children"!==t&&null!=n[t]&&o(e,t,n[t])}function i(e,n,t){for(var a in n)if("children"!==a){var i=t[a];i!==n[a]&&(null==i?r(e,a):o(e,a,i))}for(var a in t)"children"!==a&&(a in n||o(e,a,t[a]))}function c(e,n,t){e[n]=t}function l(e,n){e[n]=""}function d(e,n,t){e.setAttribute(n,t+"")}function u(e,n){e.removeAttribute(n)}function f(e){return"function"==typeof e}function v(){}function p(e){return e}function s(e,n){return function(){return e.apply(this,arguments),n.apply(this,arguments)}}function h(e,n,t){for(var o=e.length,r=-1;o--;){var a=e[++r];oe(a)?h(a,n,t):n(a,t)}}function y(e,n){e[e.length]=n}function m(e,n){if(!n)return e;for(var t=Object.keys(n),o=t.length;o--;)e[t[o]]=n[t[o]];return e}function x(){return++re}function g(e,n){e.eventStore=null;for(var t in n)0===t.indexOf("on-")&&(t=b(t),ae[t]&&(e[t]=null))}function b(e){return e.replace(/^on-/,"on").toLowerCase()}function k(e,n,t){if(n="on"+n,1===ae[n])return void(e[n]=t);var o=e.eventStore||(e.eventStore={});o[n]=t,ue[n]||(document.addEventListener(n.substr(2),N,!1),ue[n]=!0),ce&&n===de&&e.addEventListener("click",le,!1);var r=e.nodeName;"onchange"!==n||"INPUT"!==r&&"TEXTAREA"!==r||k(e,"oninput",t)}function w(e,n){if(n="on"+n,1===ae[n])return void(e[n]=null);var t=e.eventStore||(e.eventStore={});delete t[n],ce&&n===de&&e.removeEventListener("click",le,!1);var o=e.nodeName;"onchange"!==n||"INPUT"!==o&&"TEXTAREA"!==o||delete t.oninput}function N(e){for(var n=e.target,t=e.type,o="on"+t,r=null;n;){var a=n,i=a.eventStore,c=i&&i[o];if(c){if(r||(r=C(e)),r.currentTarget=n,c.call(n,r),r.$cancalBubble)break;n=n.parentNode}else n=n.parentNode}}function C(e){var n={},t=function(){return n.$cancalBubble=!0};n.nativeEvent=e,n.persist=v;for(var o in e)"function"!=typeof e[o]?n[o]=e[o]:"stopPropagation"===o||"stopImmediatePropagation"===o?n[o]=t:n[o]=e[o].bind(e);return n}function E(e,n,t){U(e.style,n,t)}function I(e,n){e.style[n]=""}function O(e,n){return e+n.charAt(0).toUpperCase()+n.substring(1)}function U(e,n,t){return!ve[n]&&se.test(t)?void(e[n]=t+"px"):("float"===n&&(n="cssFloat"),null!=t&&"boolean"!=typeof t||(t=""),void(e[n]=t))}function A(e,n,t){var o=e.vtype,r=null;return o?o===me?r=z(e,n,t):o===xe?r=F(e,n,t):o===ge&&(r=document.createComment("react-empty: "+e.uid)):r=document.createTextNode(e),r}function S(e,n,t,o){var r=e.vtype;return r===xe?W(e,n,t,o):r!==me?t:(null!=e.props[be]?(B(e,n,t,o),L(n,t,o)):(T(e,n,t,o),B(e,n,t,o)),t)}function T(e,n,t,o){var r={removes:[],updates:[],creates:[]};M(r,e,n,t,o),h(r.removes,P),h(r.updates,j),h(r.creates,R)}function j(e){if(e){var n=e.node;if(e.shouldUpdate){var t=e.vnode,o=e.newVnode,r=e.context;t.vtype?t.vtype===me?B(t,o,n,r):t.vtype===xe&&(n=W(t,o,n,r)):n.nodeValue=o}if(e.index!==e.fromIndex){var a=n.parentNode.childNodes[index];a!==n&&n.parentNode.insertBefore(n,a)}}}function P(e){V(e.vnode,e.node),e.node.parentNode.removeChild(e.node)}function R(e){var n=e.parentNode,t=n.childNodes[e.index],o=A(e.vnode,e.context,n.namespaceURI);n.insertBefore(o,t)}function V(e,n){var t=e.vtype;t===me?D(e,n):t===xe&&$(e,n)}function z(e,n,t){var o=e.type,r=e.props,i=null;return"svg"===o||t===he?(i=document.createElementNS(he,o),t=he):i=document.createElement(o),L(i,r.children,n),a(i,r),r[ke]&&r[ke].call(null,i,r),r[we]&&y(Ie,{type:we,node:i,props:r}),i}function L(e,n,t){for(var o=e.namespaceURI,r=0,a=n.length;a>r;r++)e.appendChild(A(n[r],t,o))}function M(e,n,t,o,r){var a=o.childNodes,i=n.props.children,c=t.props.children,l=i.length,d=c.length;if(0!==l)if(0!==d){for(var u={},f=Array(d),v=null,p=null,s=0;l>s;s++)for(var h=i[s],m=0;d>m;m++)if(!f[m]){var x=c[m];if(h===x){var g=!1;r&&h.vtype===xe&&h.type.length>1&&(g=!0),f[m]={shouldUpdate:g,vnode:h,newVnode:x,node:a[s],context:r,index:m,fromIndex:s},u[s]=!0;break}}for(var s=0;l>s;s++)if(!u[s]){for(var b=i[s],k=!0,m=0;d>m;m++)if(!f[m]){var w=c[m];if(w.type===b.type&&w.key===b.key){f[m]={shouldUpdate:!0,vnode:b,newVnode:w,node:a[s],context:r,index:m,fromIndex:s},k=!1;break}}k&&(v||(v=[]),y(v,{vnode:b,node:a[s]}))}for(var s=0;d>s;s++){var N=f[s];N?N.vnode.vtype===me&&M(e,N.vnode,N.newVnode,N.node,N.context):(p||(p=[]),y(p,{vnode:c[s],parentNode:o,context:r,index:s}))}v&&y(e.removes,v),p&&y(e.creates,p),y(e.updates,f)}else for(var s=0;l>s;s++)y(e.removes,{vnode:i[s],node:a[s]});else{if(0===d)return;for(var s=0;d>s;s++)y(e.creates,{vnode:c[s],parentNode:o,context:r,index:s})}}function B(e,n,t){var o=n.props;return o[Ne]&&o[Ne].call(null,t,o),i(t,e.props,o),o[Ce]&&o[Ce].call(null,t,o),t}function D(e,n){for(var t=e.props,o=t.children,r=n.childNodes,a=0,i=o.length;i>a;a++)V(o[a],r[a]);f(t[Ee])&&t[Ee].call(null,n,t),g(n,t)}function F(e,n,t){var o=G(e,n),r=A(o,n,t);return r.cache=r.cache||{},r.cache[e.uid]=o,r}function W(e,n,t,o){var r=e.uid,a=t.cache[r];delete t.cache[r];var i=G(n,o),c=H(a,i,t,o);return c.cache=c.cache||{},c.cache[n.uid]=i,c!==t&&m(c.cache,t.cache),c}function $(e,n){var t=e.uid,o=n.cache[t];delete n.cache[t],V(o,n)}function G(e,n){var t=e.type,o=e.props,r=t(o,n);if(r&&r.render&&(r=r.render()),null===r||r===!1)r={vtype:ge,uid:x()};else if(!r||!r.vtype)throw new Error("@"+t.name+"#render:You may have returned undefined, an array or some other invalid object");return r}function H(e,n,t,o){var r=t;return null==n?(V(e,t),t.parentNode.removeChild(t)):e.type!==n.type||e.key!==n.key?(V(e,t),r=A(n,o,t.namespaceURI),t.parentNode.replaceChild(r,t)):(e!==n||o)&&(r=S(e,n,t,o)),r}function X(e,n,t,o){if(!e.vtype)throw new Error("cannot render "+e+" to container");var r=n[ye]||(n[ye]=x()),a=Ue[r];if(f(t)&&(o=t,t=void 0),a)return void(a===!0?Ue[r]={vnode:e,context:t,callback:o}:(a.vnode=e,a.context=t,o&&(a.callback=a.callback?s(a.callback,o):o)));if(Ue[r]=!0,Ae.hasOwnProperty(r))H(Ae[r],e,n.firstChild,t);else{for(var i=A(e,t,n.namespaceURI),c=null;c=n.lastChild;)n.removeChild(c);n.appendChild(i)}Ae[r]=e,Oe(),a=Ue[r],Ue[r]=null,"object"==typeof a&&X(a.vnode,n,a.context,a.callback),o&&o()}function Y(e){if(!e.nodeName)throw new Error("expect node");var n=e[ye],t=null;return(t=Ae[n])?(V(t,e.firstChild),e.removeChild(e.firstChild),delete Ae[n],delete Ue[n],!0):!1}function q(e,n){var t={},o=null;if(null!=n)for(var r in n)"key"===r?void 0!==n.key&&(o=""+n.key):t[r]=n[r];var a=e.defaultProps;if(a)for(var r in a)void 0===t[r]&&(t[r]=a[r]);var i=arguments.length,c=[];if(i>2)for(var l=2;i>l;l++){var d=arguments[l];oe(d)?h(d,Q,c):Q(d,c)}t.children=c;var u=null;if("string"==typeof e)u=me;else{if("function"!=typeof e)throw new Error("unexpect type [ "+e+" ]");u=xe}var f={vtype:u,type:e,props:t,key:o};return u===xe&&(f.uid=x()),f}function J(e){return null!=e&&!!e.vtype}function K(e){var n=function(){for(var n=arguments.length,t=Array(n),o=0;n>o;o++)t[o]=arguments[o];return q.apply(void 0,[e].concat(t))};return n.type=e,n}function Q(e,n){null!=e&&"boolean"!=typeof e&&(n[n.length]=e.vtype?e:""+e)}var Z={},_=/^([^-]+)-(.+)$/,ee=null,ne={attach:c,detach:l},te={attach:d,detach:u},oe=Array.isArray,re=0;Object.freeze||(Object.freeze=p);var ae={onmouseleave:1,onmouseenter:1,onload:1,onunload:1,onscroll:1,onfocus:1,onblur:1,onrowexit:1,onbeforeunload:1,onstop:1,ondragdrop:1,ondragenter:1,ondragexit:1,ondraggesture:1,ondragover:1,oncontextmenu:1},ie={attach:k,detach:w},ce="ontouchstart"in document,le=function(){},de="onclick",ue={},fe={attach:E,detach:I},ve={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridColumn:1,fontWeight:1,lineClamp:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},pe=["Webkit","ms","Moz","O"];Object.keys(ve).forEach(function(e){pe.forEach(function(n){ve[O(n,e)]=1})});var se=/^-?\d+(\.\d+)?$/,he="http://www.w3.org/2000/svg",ye="liteid",me=1,xe=2,ge=3,be="prop-innerHTML",ke="hook-willMount",we="hook-didMount",Ne="hook-willUpdate",Ce="hook-didUpdate",Ee="hook-willUnmount",Ie=[],Oe=function(){var e=Ie.length;if(e){for(var n=Ie,t=-1;e--;){var o=n[++t];o.props[o.type].call(null,o.node,o.props)}Ie.length=0}},Ue={},Ae={};e("attr",te),e("prop",ne),e("on",ie),e("css",fe);var Se={createElement:q,createFactory:K,isValidElement:J,addDirective:e,removeDirective:n,render:X,destroy:Y};return Se});