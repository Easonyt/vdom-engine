/*!
 * vdom-engine.js v0.1.6
 * (c) 2016 Jade Gu
 * Released under the MIT License.
 */
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.Vengine=n()}(this,function(){"use strict";function e(e,n){Q[e]=n}function n(e){delete Q[e]}function t(e){var n=e.match(Z);return n?(_=n[2],Q[n[1]]):void 0}function o(e,n,o){var r=t(n);r&&r.attach(e,_,o)}function r(e,n){var o=t(n);o&&o.detach(e,_)}function a(e,n){for(var t in n)"children"!==t&&null!=n[t]&&o(e,t,n[t])}function i(e,n,t){for(var a in n)"children"!==a&&(a in t?t[a]!==n[a]&&(null==t[a]?r(e,a):o(e,a,t[a])):r(e,a));for(var a in t)"children"!==a&&(a in n||o(e,a,t[a]))}function c(e,n,t){e[n]=t}function l(e,n){e[n]=""}function d(e,n,t){e.setAttribute(n,t+"")}function u(e,n){e.removeAttribute(n)}function f(e){return"function"==typeof e}function v(){}function p(e){return e}function s(e,n){return function(){return e.apply(this,arguments),n.apply(this,arguments)}}function h(e,n,t){for(var o=e.length,r=-1;o--;){var a=e[++r];te(a)?h(a,n,t):n(a,t)}}function y(e,n){if(!n)return e;for(var t=Object.keys(n),o=t.length;o--;)e[t[o]]=n[t[o]];return e}function m(){return++oe}function x(e,n){e.eventStore=null;for(var t in n)0===t.indexOf("on-")&&(t=g(t),re[t]&&(e[t]=null))}function g(e){return e.replace(/^on-/,"on").toLowerCase()}function b(e,n,t){if(n="on"+n,1===re[n])return void(e[n]=t);var o=e.eventStore||(e.eventStore={});o[n]=t,de[n]||(document.addEventListener(n.substr(2),w,!1),de[n]=!0),ie&&n===le&&e.addEventListener("click",ce,!1);var r=e.nodeName;"onchange"!==n||"INPUT"!==r&&"TEXTAREA"!==r||b(e,"oninput",t)}function k(e,n){if(n="on"+n,1===re[n])return void(e[n]=null);var t=e.eventStore||(e.eventStore={});delete t[n],ie&&n===le&&e.removeEventListener("click",ce,!1);var o=e.nodeName;"onchange"!==n||"INPUT"!==o&&"TEXTAREA"!==o||delete t.oninput}function w(e){for(var n=e.target,t=e.type,o="on"+t,r=null;n;){var a=n,i=a.eventStore,c=i&&i[o];if(c){if(r||(r=N(e)),r.currentTarget=n,c.call(n,r),r.$cancalBubble)break;n=n.parentNode}else n=n.parentNode}}function N(e){var n={},t=function(){return n.$cancalBubble=!0};n.nativeEvent=e,n.persist=v;for(var o in e)"function"!=typeof e[o]?n[o]=e[o]:"stopPropagation"===o||"stopImmediatePropagation"===o?n[o]=t:n[o]=e[o].bind(e);return n}function C(e,n,t){O(e.style,n,t)}function E(e,n){e.style[n]=""}function I(e,n){return e+n.charAt(0).toUpperCase()+n.substring(1)}function O(e,n,t){return!fe[n]&&pe.test(t)?void(e[n]=t+"px"):("float"===n&&(n="cssFloat"),null!=t&&"boolean"!=typeof t||(t=""),void(e[n]=t))}function U(e,n,t){var o=e.vtype,r=null;return o?o===ye?r=V(e,n,t):o===me?r=D(e,n,t):o===xe&&(r=document.createComment("react-empty: "+e.uid)):r=document.createTextNode(e),r}function A(e,n,t,o){var r=e.vtype;return r===me?F(e,n,t,o):r!==ye?t:(null!=e.props[ge]?(M(e,n,t,o),z(n,t,o)):(S(e,n,t,o),M(e,n,t,o)),t)}function S(e,n,t,o){var r={removes:[],updates:[],creates:[]};L(r,e,n,t,o),h(r.removes,j),h(r.updates,T),h(r.creates,P)}function T(e){if(e){var n=e.node;if(e.shouldUpdate){var t=e.vnode,o=e.newVnode,r=e.context;t.vtype===ye?M(t,o,n,r):t.vtype===me?n=F(t,o,n,r):t.vtype||(n.nodeValue=o)}if(e.index!==e.fromIndex){var a=n.parentNode.childNodes[index];a!==n&&n.parentNode.insertBefore(n,a)}return n}}function j(e){R(e.vnode,e.node),e.node.parentNode.removeChild(e.node)}function P(e){var n=e.parentNode,t=n.childNodes[e.index],o=U(e.vnode,e.context,n.namespaceURI);n.insertBefore(o,t)}function R(e,n){var t=e.vtype;t===ye?B(e,n):t===me&&W(e,n)}function V(e,n,t){var o=e.type,r=e.props,i=null;return"svg"===o||t===se?(i=document.createElementNS(se,o),t=se):i=document.createElement(o),z(i,r.children,n),a(i,r),r[be]&&r[be].call(null,i,r),r[ke]&&Ee.push({type:ke,node:i,props:r}),i}function z(e,n,t){for(var o=e.namespaceURI,r=0,a=n.length;a>r;r++)e.appendChild(U(n[r],t,o))}function L(e,n,t,o,r){var a=o.childNodes,i=n.props.children,c=t.props.children,l=i.length,d=c.length;if(0!==l)if(0!==d){for(var u={},f=Array(d),v=null,p=null,s=0;l>s;s++)for(var h=i[s],y=0;d>y;y++)if(!f[y]){var m=c[y];if(h===m){var x=!1;r&&h.vtype===me&&h.type.length>1&&(x=!0),f[y]={shouldUpdate:x,vnode:h,newVnode:m,node:a[s],context:r,index:y,fromIndex:s},u[s]=!0;break}}for(var s=0;l>s;s++)if(!u[s]){for(var g=i[s],b=!0,y=0;d>y;y++)if(!f[y]){var k=c[y];if(k.type===g.type&&k.key===g.key){f[y]={shouldUpdate:!0,vnode:g,newVnode:k,node:a[s],context:r,index:y,fromIndex:s},b=!1;break}}b&&(v||(v=[]),v.push({vnode:g,node:a[s]}))}for(var s=0;d>s;s++){var w=f[s];w?w.vnode.vtype===ye&&L(e,w.vnode,w.newVnode,w.node,w.context):(p||(p=[]),p.push({vnode:c[s],parentNode:o,context:r,index:s}))}v&&e.removes.push(v),p&&e.creates.push(p),e.updates.push(f)}else for(var s=0;l>s;s++)e.removes.push({vnode:i[s],node:a[s]});else for(var s=0;d>s;s++)e.creates.push({vnode:c[s],parentNode:o,context:r,index:s})}function M(e,n,t){var o=n.props;return o[we]&&o[we].call(null,t,o),i(t,e.props,o),o[Ne]&&o[Ne].call(null,t,o),t}function B(e,n){for(var t=e.props,o=t.children,r=n.childNodes,a=0,i=o.length;i>a;a++)R(o[a],r[a]);f(t[Ce])&&t[Ce].call(null,n,t),x(n,t)}function D(e,n,t){var o=$(e,n),r=U(o,n,t);return r.cache=r.cache||{},r.cache[e.uid]=o,r}function F(e,n,t,o){var r=e.uid,a=t.cache[r];delete t.cache[r];var i=$(n,o),c=G(a,i,t,o);return c.cache=c.cache||{},c.cache[n.uid]=i,c!==t&&y(c.cache,t.cache),c}function W(e,n){var t=e.uid,o=n.cache[t];delete n.cache[t],R(o,n)}function $(e,n){var t=e.type,o=e.props,r=t(o,n);if(r&&r.render&&(r=r.render()),null===r||r===!1)r={vtype:xe,uid:m()};else if(!r||!r.vtype)throw new Error("@"+t.name+"#render:You may have returned undefined, an array or some other invalid object");return r}function G(e,n,t,o){var r=t;return null==n?(R(e,t),t.parentNode.removeChild(t)):e.type!==n.type||e.key!==n.key?(R(e,t),r=U(n,o,t.namespaceURI),t.parentNode.replaceChild(r,t)):(e!==n||o)&&(r=A(e,n,t,o)),r}function H(e,n,t,o){if(!e.vtype)throw new Error("cannot render "+e+" to container");var r=n[he]||(n[he]=m()),a=Oe[r];if(f(t)&&(o=t,t=void 0),a)return void(a===!0?Oe[r]={vnode:e,context:t,callback:o}:(a.vnode=e,a.context=t,o&&(a.callback=a.callback?s(a.callback,o):o)));if(Oe[r]=!0,Ue.hasOwnProperty(r))G(Ue[r],e,n.firstChild,t);else{for(var i=U(e,t,n.namespaceURI),c=null;c=n.lastChild;)n.removeChild(c);n.appendChild(i)}Ue[r]=e,Ie(),a=Oe[r],Oe[r]=null,"object"==typeof a&&H(a.vnode,n,a.context,a.callback),o&&o()}function X(e){if(!e.nodeName)throw new Error("expect node");var n=e[he],t=null;return(t=Ue[n])?(R(t,e.firstChild),e.removeChild(e.firstChild),delete Ue[n],delete Oe[n],!0):!1}function Y(e,n){var t={},o=null;if(null!=n)for(var r in n)"key"===r?void 0!==n.key&&(o=""+n.key):t[r]=n[r];var a=e.defaultProps;if(a)for(var r in a)void 0===t[r]&&(t[r]=a[r]);for(var i=arguments.length,c=[],l=2;i>l;l++){var d=arguments[l];te(d)?h(d,K,c):K(d,c)}t.children=c;var u=null;if("string"==typeof e)u=ye;else{if("function"!=typeof e)throw new Error("unexpect type [ "+e+" ]");u=me}var f={vtype:u,type:e,props:t,key:o};return u===me&&(f.uid=m()),f}function q(e){return null!=e&&!!e.vtype}function J(e){var n=function(){for(var n=arguments.length,t=Array(n),o=0;n>o;o++)t[o]=arguments[o];return Y.apply(void 0,[e].concat(t))};return n.type=e,n}function K(e,n){null!=e&&"boolean"!=typeof e&&(n[n.length]=e.vtype?e:""+e)}var Q={},Z=/^([^-]+)-(.+)$/,_=null,ee={attach:c,detach:l},ne={attach:d,detach:u},te=Array.isArray,oe=0;Object.freeze||(Object.freeze=p);var re={onmouseleave:1,onmouseenter:1,onload:1,onunload:1,onscroll:1,onfocus:1,onblur:1,onrowexit:1,onbeforeunload:1,onstop:1,ondragdrop:1,ondragenter:1,ondragexit:1,ondraggesture:1,ondragover:1,oncontextmenu:1},ae={attach:b,detach:k},ie="ontouchstart"in document,ce=function(){},le="onclick",de={},ue={attach:C,detach:E},fe={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridColumn:1,fontWeight:1,lineClamp:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},ve=["Webkit","ms","Moz","O"];Object.keys(fe).forEach(function(e){ve.forEach(function(n){fe[I(n,e)]=1})});var pe=/^-?\d+(\.\d+)?$/,se="http://www.w3.org/2000/svg",he="liteid",ye=1,me=2,xe=3,ge="prop-innerHTML",be="hook-willMount",ke="hook-didMount",we="hook-willUpdate",Ne="hook-didUpdate",Ce="hook-willUnmount",Ee=[],Ie=function(){var e=Ee.length;if(e){for(var n=Ee,t=-1;e--;){var o=n[++t];o.props[o.type].call(null,o.node,o.props)}Ee.length=0}},Oe={},Ue={};e("attr",ne),e("prop",ee),e("on",ae),e("css",ue);var Ae={createElement:Y,createFactory:J,isValidElement:q,addDirective:e,removeDirective:n,render:H,destroy:X};return Ae});