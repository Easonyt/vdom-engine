/*!
 * vdom-engine.js v0.1.6
 * (c) 2016 Jade Gu
 * Released under the MIT License.
 */
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.Vengine=n()}(this,function(){"use strict";function e(e,n){K[e]=n}function n(e){delete K[e]}function t(e){var n=e.match(Q);return n?(Z=n[2],K[n[1]]):void 0}function o(e,n,o){var r=t(n);r&&r.attach(e,Z,o)}function r(e,n){var o=t(n);o&&o.detach(e,Z)}function a(e,n){for(var t in n)"children"!==t&&null!=n[t]&&o(e,t,n[t])}function i(e,n,t){for(var a in n)"children"!==a&&(t.hasOwnProperty(a)?t[a]!==n[a]&&(null==t[a]?r(e,a):o(e,a,t[a])):r(e,a));for(var a in t)"children"!==a&&(n.hasOwnProperty(a)||o(e,a,t[a]))}function c(e,n,t){e[n]=t}function l(e,n){e[n]=""}function u(e,n,t){e.setAttribute(n,t+"")}function d(e,n){e.removeAttribute(n)}function f(e){return"function"==typeof e}function v(){}function p(e){return e}function s(e,n){return function(){return e.apply(this,arguments),n.apply(this,arguments)}}function h(e,n,t){for(var o=e.length,r=-1;o--;){var a=e[++r];te(a)?h(a,n,t):n(a,t)}}function y(){return++oe}function m(e,n){e.eventStore=null;for(var t in n)0===t.indexOf("on-")&&(t=g(t),re[t]&&(e[t]=null))}function g(e){return e.replace(/^on-/,"on").toLowerCase()}function x(e,n,t){if(n="on"+n,1===re[n])return void(e[n]=t);var o=e.eventStore||(e.eventStore={});o[n]=t,ue[n]||(document.addEventListener(n.substr(2),k,!1),ue[n]=!0),ie&&n===le&&e.addEventListener("click",ce,!1);var r=e.nodeName;"onchange"!==n||"INPUT"!==r&&"TEXTAREA"!==r||x(e,"oninput",t)}function b(e,n){if(n="on"+n,1===re[n])return void(e[n]=null);var t=e.eventStore||(e.eventStore={});delete t[n],ie&&n===le&&e.removeEventListener("click",ce,!1);var o=e.nodeName;"onchange"!==n||"INPUT"!==o&&"TEXTAREA"!==o||delete t.oninput}function k(e){for(var n=e.target,t=e.type,o="on"+t,r=null;n;){var a=n,i=a.eventStore,c=i&&i[o];if(c){if(r||(r=w(e)),r.currentTarget=n,c.call(n,r),r.$cancalBubble)break;n=n.parentNode}else n=n.parentNode}}function w(e){var n={},t=function(){return n.$cancalBubble=!0};n.nativeEvent=e,n.persist=v;for(var o in e)"function"!=typeof e[o]?n[o]=e[o]:"stopPropagation"===o||"stopImmediatePropagation"===o?n[o]=t:n[o]=e[o].bind(e);return n}function N(e,n,t){O(e.style,n,t)}function C(e,n){e.style[n]=""}function E(e,n){return e+n.charAt(0).toUpperCase()+n.substring(1)}function O(e,n,t){return!fe[n]&&pe.test(t)?void(e[n]=t+"px"):("float"===n&&(n="cssFloat"),null!=t&&"boolean"!=typeof t||(t=""),void(e[n]=t))}function I(e,n,t){var o=e.vtype,r=null;return o?o===ye?r=R(e,n,t):o===me?r=M(e,n,t):o===ge&&(r=document.createComment("react-empty: "+e.uid)):r=document.createTextNode(e),r}function A(e,n,t,o){var r=e.vtype;if(r===me)return $(e,n,t,o);if(r!==ye)return t;var a=e.props[xe]&&e.props[xe].__html;return null!=a?(D(e,n,t,o),j(n,t,o)):(U(e,n,t,o),D(e,n,t,o)),t}function U(e,n,t,o){var r={removes:[],updates:[],creates:[]};z(r,e,n,t,o),h(r.removes,S),h(r.updates,P),h(r.creates,T)}function P(e){if(e){var n=e.vnode,t=e.node;e.shouldIgnore||(n.vtype===ye?D(n,e.newVnode,t,e.context):n.vtype===me?t=$(n,e.newVnode,t,e.context):n.vtype||t.replaceData(0,t.length,e.newVnode));var o=t.parentNode.childNodes[e.index];return o!==t&&t.parentNode.insertBefore(t,o),t}}function S(e){V(e.vnode,e.node),e.node.parentNode.removeChild(e.node)}function T(e){var n=I(e.vnode,e.context,e.parentNode.namespaceURI);e.parentNode.insertBefore(n,e.parentNode.childNodes[e.index])}function V(e,n){var t=e.vtype;t===ye?L(e,n):t===me&&B(e,n)}function R(e,n,t){var o=e.type,r=e.props,i=null;return"svg"===o||t===se?(i=document.createElementNS(se,o),t=se):i=document.createElement(o),j(i,r.children,n),a(i,r),r[be]&&r[be].call(null,i,r),r[ke]&&(Ee[Ee.length]=function(){r[ke].call(null,i,r)}),i}function j(e,n,t){for(var o=e.namespaceURI,r=0,a=n.length;a>r;r++)e.appendChild(I(n[r],o,t))}function z(e,n,t,o,r){var a=o.childNodes,i=n.props.children,c=t.props.children,l=i.length,u=c.length;if(0!==l)if(0!==u){for(var d=Array(u),f=null,v=null,p=0;l>p;p++)for(var s=i[p],h=0;u>h;h++)if(!d[h]){var y=c[h];if(s===y){var m=!0;r&&s.vtype===me&&s.type.length>1&&(m=!1),d[h]={shouldIgnore:m,vnode:s,newVnode:y,node:a[p],context:r,index:h},i[p]=null;break}}for(var p=0;l>p;p++){var g=i[p];if(null!==g){for(var x=!0,h=0;u>h;h++)if(!d[h]){var b=c[h];if(b.type===g.type&&b.key===g.key){d[h]={vnode:g,newVnode:b,node:a[p],context:r,index:h},x=!1;break}}x&&(f||(f=[]),f.push({vnode:g,node:a[p]}))}}for(var p=0;u>p;p++){var k=d[p];k?k.vnode.vtype===ye&&z(e,k.vnode,k.newVnode,k.node,k.context):(v||(v=[]),v.push({vnode:c[p],parentNode:o,context:r,index:p}))}f&&e.removes.push(f),v&&e.creates.push(v),e.updates.push(d)}else for(var p=0;l>p;p++)e.removes.push({vnode:i[p],node:a[p]});else if(u>0)for(var p=0;u>p;p++)e.creates.push({vnode:c[p],parentNode:o,context:r,index:p})}function D(e,n,t){var o=n.props;return o[we]&&o[we].call(null,t,o),i(t,e.props,o),o[Ne]&&o[Ne].call(null,t,o),t}function L(e,n){for(var t=e.props,o=t.children,r=n.childNodes,a=0,i=o.length;i>a;a++)V(o[a],r[a]);f(t[Ce])&&t[Ce].call(null,n,t),m(n,t)}function M(e,n,t){var o=F(e,n),r=I(o,n,t);return r.cache=r.cache||{},r.cache[e.uid]=o,r}function $(e,n,t,o){var r=e.uid,a=t.cache[r];delete t.cache[r];var i=F(n,o),c=W(a,i,t,o);return c.cache=c.cache||{},c.cache[n.uid]=i,c!==t&&G(c.cache,t.cache,c),c}function B(e,n){var t=e.uid,o=n.cache[t];delete n.cache[t],V(o,n)}function F(e,n){var t=e.type,o=e.props,r=t(o,n);if(r&&r.render&&(r=r.render()),null===r||r===!1)r={vtype:ge,uid:y()};else if(!r||!r.vtype)throw new Error("@"+t.name+"#render:You may have returned undefined, an array or some other invalid object");return r}function W(e,n,t,o){var r=t;return null==n?(V(e,t),t.parentNode.removeChild(t)):e.type!==n.type||e.key!==n.key?(V(e,t),r=I(n,o,t.namespaceURI),t.parentNode.replaceChild(r,t)):(e!==n||o)&&(r=A(e,n,t,o)),r}function G(e,n,t){for(var o in n)if(n.hasOwnProperty(o)){var r=n[o];e[o]=r,r.forceUpdate&&(r.$cache.node=t)}}function H(e,n,t,o){if(!e.vtype)throw new Error("cannot render "+e+" to container");var r=n[he]||(n[he]=y()),a=Ie[r];if(f(t)&&(o=t,t=void 0),a)return void(a===!0?Ie[r]={vnode:e,context:t,callback:o}:(a.vnode=e,a.context=t,o&&(a.callback=a.callback?s(a.callback,o):o)));if(Ie[r]=!0,Ae.hasOwnProperty(r))W(Ae[r],e,n.firstChild,t);else{for(var i=I(e,t,n.namespaceURI),c=null;c=n.lastChild;)n.removeChild(c);n.appendChild(i)}Ae[r]=e,Oe(),a=Ie[r],Ie[r]=null,"object"==typeof a&&H(a.vnode,n,a.context,a.callback),o&&o()}function X(e){if(!e.nodeName)throw new Error("expect node");var n=e[he],t=null;return(t=Ae[n])?(V(t,e.firstChild),e.removeChild(e.firstChild),delete Ae[n],delete Ie[n],!0):!1}function _(e,n){var t={},o=null;if(null!=n)for(var r in n)"key"===r?void 0!==n.key&&(o=""+n.key):t[r]=n[r];var a=e.defaultProps;if(a)for(var r in a)void 0===t[r]&&(t[r]=a[r]);for(var i=arguments.length,c=[],l=2;i>l;l++){var u=arguments[l];te(u)?h(u,J,c):J(u,c)}t.children=c;var d=null;if("string"==typeof e)d=ye;else{if("function"!=typeof e)throw new Error("unexpect type [ "+e+" ]");d=me}var f={vtype:d,type:e,props:t,key:o};return d===me&&(f.uid=y()),f}function Y(e){return null!=e&&!!e.vtype}function q(e){var n=function(){for(var n=arguments.length,t=Array(n),o=0;n>o;o++)t[o]=arguments[o];return _.apply(void 0,[e].concat(t))};return n.type=e,n}function J(e,n){null!=e&&"boolean"!=typeof e&&(n[n.length]=e.vtype?e:""+e)}var K={},Q=/^([^-]+)-(.+)$/,Z=null,ee={attach:c,detach:l},ne={attach:u,detach:d},te=Array.isArray,oe=0;Object.freeze||(Object.freeze=p);var re={onmouseleave:1,onmouseenter:1,onload:1,onunload:1,onscroll:1,onfocus:1,onblur:1,onrowexit:1,onbeforeunload:1,onstop:1,ondragdrop:1,ondragenter:1,ondragexit:1,ondraggesture:1,ondragover:1,oncontextmenu:1},ae={attach:x,detach:b},ie="ontouchstart"in document,ce=function(){},le="onclick",ue={},de={attach:N,detach:C},fe={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridColumn:1,fontWeight:1,lineClamp:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},ve=["Webkit","ms","Moz","O"];Object.keys(fe).forEach(function(e){ve.forEach(function(n){fe[E(n,e)]=1})});var pe=/^-?\d+(\.\d+)?$/,se="http://www.w3.org/2000/svg",he="liteid",ye=1,me=2,ge=3,xe="prop-innerHTML",be="hook-willMount",ke="hook-didMount",we="hook-willUpdate",Ne="hook-didUpdate",Ce="hook-willUnmount",Ee=[],Oe=function(){var e=Ee.length;if(e){for(var n=Ee,t=-1;e--;){var o=n[++t];o.onmount.call(null,o),o.onmount=null}Ee.length=0}},Ie={},Ae={};e("attr",ne),e("prop",ee),e("on",ae),e("css",de);var Ue={createElement:_,createFactory:q,isValidElement:Y,addDirective:e,removeDirective:n,render:H,destroy:X};return Ue});